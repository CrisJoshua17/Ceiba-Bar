<div class="container">
  <h2>Seguimiento en Vivo - Pedido #{{ orderId }}</h2>

  <!-- Verificación para invitados -->
  <div *ngIf="!isVerified" class="verification-wrapper">
    <div class="verification-card">
      <i class="pi pi-lock-open mb-3" style="font-size: 2rem; color: #6366f1;"></i>
      <h3>Verifica tu identidad</h3>
      <p>Para rastrear tu pedido como invitado, ingresa el email utilizado en la compra.</p>
      <div class="form">
        <input [(ngModel)]="emailInput" placeholder="tu@email.com" class="input" type="email"
          (keyup.enter)="verifyGuest()" />
        <button (click)="verifyGuest()" class="btn" [disabled]="!emailInput.trim() || verifying">
          {{ verifying ? 'Verificando...' : 'Verificar' }}
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="isVerified" class="tracking-content">
    <!-- Formulario de dirección -->
    <div *ngIf="!addressSent" class="form">
      <input [(ngModel)]="address" placeholder="Ej: Insurgentes Sur 300, CDMX" class="input"
        (keyup.enter)="sendAddress()" />
      <button (click)="sendAddress()" class="btn" [disabled]="!address.trim()">
        Enviar Dirección
      </button>
    </div>

    <!-- Estado -->
    <div *ngIf="addressSent" class="status">
      <p><strong>Estado:</strong> {{ status }}</p>

      <div class="route-info" *ngIf="distance !== null">
        <p>
          Distancia restante:
          <strong>{{ distance | number:'1.2-2' }} km</strong>
        </p>
      </div>
    </div>

    <!-- Mapa -->
    <div #map class="map"></div>
  </div>
</div>