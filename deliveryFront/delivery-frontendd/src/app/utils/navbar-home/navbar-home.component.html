<nav class="navbar navbar-expand-lg w-100 myNavbar">
  <div class="container-fluid">
    <!-- Logo Desktop -->
    <a class="navbar-brand d-none d-lg-block" routerLink="/">
      <p-avatar class="myLogo" image="assets/images/logoarbol.jpg" shape="circle" />
    </a>

    <!-- Logo centrado en m칩vil -->
    <a class="navbar-brand d-lg-none mx-auto" routerLink="/">
      <p-avatar class="myLogo" image="assets/images/logoarbol.jpg" shape="circle" />
    </a>

    <!-- Bot칩n hamburguesa -->
    <button class="navbar-toggler d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebarMenu"
      aria-controls="sidebarMenu" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Men칰 horizontal (solo desktop) -->
    <div class="collapse navbar-collapse" id="navbarDesktop">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" routerLink="/">INICIO</a>
        </li>
        <li class="nav-item dropdown mx-2">
          <a class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            MEN칔
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" routerLink="/menu/drinks">Drinks</a></li>
            <li><a class="dropdown-item" routerLink="/menu/snack">Snacks</a></li>
            <li><a class="dropdown-item" routerLink="/menu/recetario">Recetario</a></li>
          </ul>
        </li>
      </ul>
      <div class="d-flex align-items-center">
        <button class="cart-button">
          <i class="pi pi-user mx-2 social-icon" style="color: black" [routerLink]="['/login']"></i>
        </button>
        <button class="cart-button" (click)="cartDrawerVisible = true">
          <i class="pi pi-shopping-cart mx-3 social-icon p-overlay-badge" style="color: black">
            <p-badge [value]="cartService.cartItemsCount()" severity="danger"></p-badge>
          </i>
        </button>
        <a href="https://www.facebook.com/share/15fkBAVpr5/?mibextid=wwXIfr" target="_blank" rel="noopener noreferrer">
          <i class="pi pi-facebook mx-2 social-icon facebook"></i>
        </a>
        <a href="https://wa.me/525578951973" target="_blank" rel="noopener noreferrer">
          <i class="pi pi-whatsapp social-icon whatsapp mx-2"></i>
        </a>
        <a href="https://www.instagram.com/elhombre.globo?igsh=MXN0aDRrdndsOGRi&utm_source=qr" target="_blank"
          rel="noopener noreferrer">
          <i class="pi pi-instagram social-icon instagram mx-2"></i>
        </a>
      </div>
    </div>
  </div>
</nav>

<!-- Right Drawer (Sidebar) del carrito -->
<p-drawer [(visible)]="cartDrawerVisible" position="right" [blockScroll]="true" [dismissible]="true"
  [showCloseIcon]="true" [baseZIndex]="10000" [style]="{'width': '450px'}">

  <ng-template pTemplate="header">
    <div class="sidebar-header">
      <h3 class="text-white">Tu Carrito 游</h3>
      <span class="cart-count">{{ cartService.cartItemsCount() }} items</span>
    </div>
  </ng-template>

  <!-- Contenido del carrito -->
  <div class="cart-content">

    <!-- Si el carrito est치 vac칤o -->
    @if(cartService.getCartItems().length === 0){
    <div class="empty-cart">
      <i class="pi pi-shopping-cart empty-icon"></i>
      <p class="productText">Tu carrito est치 vac칤o</p>
      <p-button label="Seguir Comprando" [style]="{'background-color':'#123458', 'color':'white', 'border':'none'}"
        (onClick)="cartDrawerVisible = false"></p-button>
    </div>
    }
    @else {
    <!-- Lista de productos -->
    <div class="cart-items">
      <div class="cart-item" *ngFor="let item of cartService.getCartItems()">

        <!-- Imagen del producto -->
        <div class="cart-product-image mr-3">
          <img [src]="getImageUrl(item.product.image)" [alt]="item.product.name"
            style="width: 60px; height: 60px; object-fit: cover; border-radius: 8px;" />
        </div>
        <!-- Info del producto -->
        <div class="item-info">
          <h4 class="productText">{{ item.product.name }}</h4>
          <p class="item-price">{{ item.product.price | currency:'MXN':'symbol':'1.2-2' }}</p>
        </div>
        <!-- Controles (+ - eliminar) -->
        <div class="item-controls">
          <div class="quantity-controls">
            <button (click)="decreaseQuantity(item.product.id)" class="qty-btn">-</button>
            <span class="quantity">{{ item.quantity }}</span>
            <button (click)="increaseQuantity(item.product.id)" class="qty-btn">+</button>
          </div>
          <button (click)="removeFromCart(item.product.id)" class="remove-btn">
            <i class="pi pi-trash"></i>
          </button>
        </div>
      </div>
    </div>
    <!-- Footer del carrito -->
    <div class="cart-footer">
      <div class="cart-total">
        <strong class="productText">Total: {{ cartService.cartTotal() | currency:'MXN':'symbol':'1.2-2' }}</strong>
      </div>
      <div class="cart-actions">
        <p-button label="Limpiar Carrito" [style]="{'background-color':'#D4C9BE', 'color':'black', 'border':'none'}"
          (onClick)="clearCart()" class="mr-2" size="small"></p-button>
        <p-button label="Finalizar Compra"
          [style]="{'background-color':'#123458', 'color':'white', 'border':'1px solid white'}"
          (onClick)="cartService.finalizarCompra()" size="small"></p-button>
      </div>
    </div>
    }
  </div>
</p-drawer>

<!-- OFFCANVAS SIDEBAR -->
<div class="offcanvas offcanvas-start" tabindex="-1" id="sidebarMenu" aria-labelledby="sidebarMenuLabel">
  <div class="offcanvas-header text-white">
    <h5 class="offcanvas-title fw-bold" id="sidebarMenuLabel">Men칰</h5>
    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body p-0">
    <ul class="list-group list-group-flush">
      <!-- INICIO -->
      <li class="list-group-item">
        <a routerLink="/" class="nav-link text-white fw-bold d-block py-3 px-4 hover-scale">
          INICIO
        </a>
      </li>

      <!-- MEN칔 con dropdown -->
      <li class="list-group-item hover-parent">
        <a class="nav-link dropdown-toggle text-black d-block py-3 px-4" role="button" data-bs-toggle="dropdown"
          aria-expanded="false">
          MEN칔
        </a>
        <ul class="dropdown-menu w-100">
          <li><a class="dropdown-item" routerLink="/menu/drinks">Drinks</a></li>
          <li><a class="dropdown-item" routerLink="/menu/snack">Snacks</a></li>
          <li><a class="dropdown-item" routerLink="/menu/recetario">Recetario</a></li>
        </ul>
      </li>
    </ul>

    <!-- Iconos  -->
    <div class="p-4 border-top d-flex justify-content-center gap-2">
      <i class="pi pi-user mx-1 social-icon" style="color: black" [routerLink]="['/login']"></i>
      <i class="pi pi-shopping-cart mx-3 social-icon p-overlay-badge" style="color: black">
        <p-badge [value]="cartService.cartItemsCount()" severity="danger"></p-badge>
      </i>

      <a href="https://www.facebook.com/share/15fkBAVpr5/?mibextid=wwXIfr" target="_blank" rel="noopener noreferrer">
        <i class="pi pi-facebook mx-1 social-icon facebook"></i>
      </a>
      <a href="https://wa.me/525578951973" target="_blank" rel="noopener noreferrer">
        <i class="pi pi-whatsapp social-icon whatsapp mx-1"></i>
      </a>
      <a href="https://www.instagram.com/elhombre.globo?igsh=MXN0aDRrdndsOGRi&utm_source=qr" target="_blank"
        rel="noopener noreferrer">
        <i class="pi pi-instagram social-icon instagram mx-1"></i>
      </a>
    </div>
  </div>
</div>